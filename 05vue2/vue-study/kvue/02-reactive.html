<!--
 * @Author: Wangchaoke gxk_wck@163.com
 * @Date: 2022-10-27 22:35:06
 * @LastEditors: Wangchaoke gxk_wck@163.com
 * @LastEditTime: 2022-10-27 23:14:53
 * @FilePath: /growUp/02vue/vue-study/kvue/02-reactive.html
 * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->

<!-- 
* 简易vue双向绑定的原理其实很简单可以理解为以下两个步骤
* 1、用 Object.defineProperty 为数据做监听
* 2、当数据变更时去更新Dom 就可以了
-->
<div id="app">
    {{foo}}
</div>
<script>
    function defineReactive(obj, key, val) {
        Object.defineProperty(obj, key, {
            get() {
                // console.log('get', key);
                return val
            },
            set(v) {
                if (val !== v) {
                    val = v
                    update()
                }
            },
        })
    }

    function update() {
        app.innerText = obj.foo
    }

    const obj = {}
    defineReactive(obj, 'foo', 'foo')

    setInterval(() => {
        obj.foo = new Date().toLocaleTimeString()
    }, 1000)
</script>